CREATE DATABASE registration_db;

USE registration_db;

-- Users table
CREATE TABLE IF NOT EXISTS users (
    uid INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(255) NOT NULL UNIQUE,
    email VARCHAR(255) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    modified_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    role ENUM('student', 'teacher', 'admin') NOT NULL
);

-- Teachers table
CREATE TABLE IF NOT EXISTS teachers (
    teacher_id INT PRIMARY KEY,
    full_name VARCHAR(255) NOT NULL,
    dob DATE NOT NULL,
    last_degree VARCHAR(100) NOT NULL,
    contact VARCHAR(20) NOT NULL,
    gender ENUM('Male', 'Female', 'Other') NOT NULL,
    address TEXT NOT NULL,
    expertise VARCHAR(255) NOT NULL,
    subjects_taught TEXT NOT NULL,
    experience_years INT NOT NULL,
    industry_experience_years INT NOT NULL,
    research_papers INT NOT NULL,
    department VARCHAR(100) NOT NULL,
    college VARCHAR(255) NOT NULL,
    FOREIGN KEY (teacher_id) REFERENCES users(uid)
);

-- Students table
CREATE TABLE IF NOT EXISTS students (
    student_id INT PRIMARY KEY,
    full_name VARCHAR(255) NOT NULL,
    roll_no VARCHAR(50) NOT NULL UNIQUE,
    enrollment_no VARCHAR(50) NOT NULL UNIQUE,
    contact VARCHAR(20) NOT NULL,
    dob DATE NOT NULL,
    course VARCHAR(100) NOT NULL,
    gender ENUM('Male', 'Female', 'Other') NOT NULL,
    address TEXT NOT NULL,
    department VARCHAR(100) NOT NULL,
    college VARCHAR(255) NOT NULL,
    FOREIGN KEY (student_id) REFERENCES users(uid)
);

-- Admins table
CREATE TABLE IF NOT EXISTS admins (
    admin_id INT PRIMARY KEY,
    full_name VARCHAR(255) NOT NULL,
    FOREIGN KEY (admin_id) REFERENCES users(uid)
);

-- Questions table
CREATE TABLE IF NOT EXISTS questions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    teacher_id INT NOT NULL,
    question_text TEXT NOT NULL,
    keywords TEXT NOT NULL,
    actual_answer TEXT NOT NULL,
    FOREIGN KEY (teacher_id) REFERENCES users(uid)
);

-- Answers table
CREATE TABLE IF NOT EXISTS answers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    student_id INT NOT NULL,
    question_id INT NOT NULL,
    answer_text TEXT NOT NULL,
    FOREIGN KEY (student_id) REFERENCES users(uid),
    FOREIGN KEY (question_id) REFERENCES questions(id)
);
